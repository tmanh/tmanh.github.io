<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme" content="hugo-academic">
    <meta name="generator" content="Hugo 0.37.1"/>
    <meta name="author" content="Anh-Truong">
    <meta name="description" content="">

    <link rel="alternate" hreflang="en-us" href="http://tmanh.github.io/posts/jaist/">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">

    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/css/custom-theme.css">

    <script>
        window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
        ga('create', 'UA-2381283-3', 'auto');
        ga('require', 'eventTracker');
        ga('require', 'outboundLinkTracker');
        ga('require', 'urlChangeTracker');
        ga('send', 'pageview');
    </script>

    <script async src="//www.google-analytics.com/analytics.js"></script>
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>

    <link rel="manifest" href="/site.webmanifest">
    <link rel="icon" type="image/png" href="/images/icon.png">
    <link rel="apple-touch-icon" type="image/png" href="/img/icon-apple.png">

    <link rel="canonical" href="http://tmanh.github.io/posts/how-to-install-tensorflow-on-jaist-cluster-computer/">

    <meta property="og:site_name" content="Anh&#39;s blog">
    <meta property="og:url" content="http://tmanh.github.io/posts/jaist/how-to-install-tensorflow-on-jaist-cluster-computer/">
    <meta property="og:title" content="How to install Tensorflow on JAIST CX250 Cluster Computer | Anh&#39;s blog">
    <meta property="og:description" content="">
    <meta property="og:locale" content="en-us">

    <meta property="og:updated_time" content="2018-04-08">


    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-2248880369139457",
            enable_page_level_ads: true
        });
    </script>

    <title>How to install Tensorflow on JAIST CX250 Cluster Computer | Anh&#39;s blog</title>
</head>

<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">
    <nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                        data-target=".navbar-collapse" aria-expanded="false">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>

                <a class="navbar-brand" href="/">Anh&#39;s blog </a>
            </div>

            <div class="collapse navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li class="nav-item">
                        <a href="/posts/" data-target="/posts/">
                            <span>Posts</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="/#about" data-target="#about">
                            <span>Home</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="/#projects" data-target="#projects">
                            <span>Projects</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="/#publications" data-target="#publications">
                            <span>Publications</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a href="/about/" data-target="/about/">
                            <span>About</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <article class="article" itemscope itemtype="http://schema.org/Article">
        <div class="article-container">
            <h1 itemprop="name" align="justify">How to install Tensorflow on JAIST CX250 Cluster Computer</h1>

            <div class="article-metadata">
                <span class="article-date">
                    <time datetime="2018-05-05 10:11:00 &#43;0000 UTC" itemprop="datePublished">
                        2018-05-05
                    </time>
                </span>

                <div class="share-box" aria-hidden="true">
                    <ul class="share">
                        <li>
                          <a class="email"
                             href="mailto:?subject=How%20to%20install%20Tensorflow%20on%20JAIST%20CX250%20Cluster%20Computer&amp;body=http%3a%2f%2ftmanh.github.io%2fposts%2fjaist%2fhow-to-install-tensorflow-on-jaist-cluster-computer%2f">
                            <i class="fa fa-envelope"></i>
                          </a>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="article-style" itemprop="articleBody">
                <p align="justify"> <b>Why do I need CX250 Cluster?</b> </p>
                <blockquote>
                    <p>Your computer does not have GPU or it is not suitable for running code. (JAIST has introduced another cluster computer with P100. It's much more powerful than CX250. It also supports tensorflow. So, you don't need to suffer the installation process that I described below.)</p>
                </blockquote>

                <p align="justify"> In the past, we could not install Tensorflow on CX250 Cluster because its GLIBC is too old for running Tensorflow. But, recently, they added a folder with new GLIBC. It allows us to run python and tensorflow with new GLIBC. So, I write this blog to show you the way to run tensorflow with the alternative GLIBC. </p>

                <p align="justify"> <b>Step 1:</b> Install Python </p>
                <ul style="list-style-type:disc">
                    <li>
                        Before installing Python, log in to the CX250 Cluster. Then, you have to download the source code from this <a href="https://www.python.org/downloads/">site</a>. For example:

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>wget https://www.python.org/ftp/python/2.7.14/Python-2.7.14.tar.xz</code></pre>
                        </div>
                    </li>

                    <li>
                        Then, you have to extract the compressed file and compile Python from the source code and install it in your working directory. For example:

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>tar -xzvf Python-2.7.14.tar.xz<br>cd Python-2.7.14<br>./configure --enable-shared --prefix=/work/${USER}/python/py27 LDFLAGS="-Wl,--rpath=/usr/local/lib"<br>make<br>make install</code></pre>
                        </div>
                    </li>

                    <li>
                        If you have any problems which related to unicode while importing Tensorflow, you have to rebuild Python with enable-unicode flag. For example:

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>./configure --enable-shared --enable-unicode=ucs4 --prefix=/work/${USER}/python/py27 LDFLAGS="-Wl,--rpath=/usr/local/lib"<br>make<br>make install</code></pre>
                        </div>
                    </li>
                </ul>

                <p align="justify"> <b>Step 2 (Optional):</b> Install cuDNN. If you want to install the newest Tensorflow version (after version 1.2.0), you have to install a newer cuDNN version. </p>
                <ul style="list-style-type:disc">
                    <li>
                        Download the required cuDNN (in my case, it's cuDNN v6.0) from NVIDIA website.

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>wget http://developer.download.nvidia.com/compute/redist/cudnn/v6.0/cudnn-8.0-linux-x64-v6.0.tgz<br>tar -xzvf cudnn-8.0-linux-x64-v6.0.tgz<br>mv cuda cudnn</code></pre>
                        </div>
                    </li>
                </ul>

                <p align="justify"> <b>Step 3:</b> Set environment variables</p>
                <ul style="list-style-type:disc">
                    <li>
                        Go to your home directory.

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>cd ~</code></pre>
                        </div>
                    </li>

                    <li>
                        Create <i> .tcshrc </i> file with the following content. I also created a alias named <code>python-tf</code> to run python with the alternative GLIBC.

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>module unload cuda<br>module load cuda/8.0<br><br># IMPORT CUDA<br>setenv LD_LIBRARY_PATH  /opt/cuda/8.0/lib64:/work/${USER}/cudnn/lib64<br><br># IMPORT GCC<br>setenv LD_LIBRARY_PATH  /work/opt/gcc485/lib64:${LD_LIBRARY_PATH}<br><br># PYTHON PATH<br>setenv PYTHON_PATH      /work/${USER}/python/py27<br><br># IMPORT PYTHON<br>setenv LD_LIBRARY_PATH  /work/${USER}/python/py27-14/lib:${LD_LIBRARY_PATH}<br><br># IMPORT GLIBC<br>setenv LDPATH           /work/opt/glibc-2.17/lib/ld-linux-x86-64.so.2<br>setenv LDLIBS           ${LD_LIBRARY_PATH}:/work/opt/glibc-2.17/lib:/usr/lib64:/usr/lib:/lib64<br><br># ALIAS<br>alias python-tf "${LDPATH} --library-path ${LDLIBS} ${PYTHON_PATH}/bin/python"</code></pre>
                        </div>
                    </li>

                    <li>
                        If you do not use any newer versions of cuDNN. Then, just remove the cuDNN directory while importing CUDA.

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code># IMPORT CUDA<br>setenv LD_LIBRARY_PATH  /opt/cuda/8.0/lib64</code></pre>
                        </div>
                    </li>
                </ul>

                <p align="justify"> <b>Step 3:</b> Install Tensorflow</p>
                    <li>
                        Install pip from this <a href="https://pip.pypa.io/en/stable/installing/">site</a>

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>wget https://bootstrap.pypa.io/get-pip.py<br>python get-pip.py</code></pre>
                        </div>
                    </li>

                    <li>
                        After that, you have to log out and log in to the cluster computer once again.
                    </li>

                    <li>
                        Now, install your expected Tensorflow version. For example:

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>pip install https://storage.googleapis.com/tensorflow/linux/gpu/tensorflow_gpu-1.4.0-cp27-none-linux_x86_64.whl</code></pre>
                        </div>
                    </li>

                    <li>
                        Finally, try to run a small example code.

                        <div class="highlighter-rouge">
                            <pre class="highlight"><code>python-tf<br>import tensorflow as tf<br><br>sess = tf.Session()<br><br>a = tf.constant(5)<br>b = tf.constant(5)<br><br>print(sess.run(a + b))</code></pre>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </article>

    <div class="container">
        <nav>
            <ul class="pager">
                <li class="previous"><a href="https://tmanh.github.io/posts/jaist/how-to-reserve-a-seminar-room/"><span
                  aria-hidden="true">&larr;</span> How to reserve a seminar room</a></li>
            </ul>
        </nav>
    </div>

    <div class="article-container">
        <section id="comments">
            <div id="disqus_thread"></div>
            <script>
                var disqus_config = function () {
                };

                (function() {
                    if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
                        document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
                        return;
                    }
                    var d = document, s = d.createElement('script'); s.async = true;
                    s.src = '//' + "tmanhblog" + '.disqus.com/embed.js';
                    s.setAttribute('data-timestamp', +new Date());
                    (d.head || d.body).appendChild(s);
                })();
            </script>

            <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </section>
    </div>

    <footer class="site-footer">
        <div class="container">
            <p class="powered-by">
                &copy; 2018 Anh Truong &middot;
                Powered by the
                <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
                <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

                <span class="pull-right" aria-hidden="true">
                <a href="#" id="back_to_top">
                    <span class="button_icon">
                    <i class="fa fa-chevron-up fa-2x"></i>
                    </span>
                </a>
                </span>
            </p>
        </div>
    </footer>

    <div id="modal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Cite</h4>
                </div>
                <div>
                    <pre><code class="modal-body tex"></code></pre>
                </div>
                <div class="modal-footer">
                    <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
                        <i class="fa fa-copy"></i> Copy
                    </a>
                    <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
                        <i class="fa fa-download"></i> Download
                    </a>
                    <div id="modal-error"></div>
                </div>
            </div>
        </div>
    </div>

    <script id="dsq-count-scr" src="//tmanhblog.disqus.com/count.js" async></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>

    <script src="/js/hugo-academic.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

    <script>hljs.initHighlightingOnLoad();</script>

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
</body>

</html>
